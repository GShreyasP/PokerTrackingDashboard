<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poker Money Tracker</title>
    <link rel="stylesheet" href="/style.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="/firebase-init.js"></script>
</head>
<body>
    <div class="container">
        <div class="page-header">
            <h1>Poker Money Tracker</h1>
            <div id="header-user-info" class="header-user-info hidden">
                <span id="header-user-name"></span>
                <button id="header-sign-out-btn" class="btn btn-sign-out" onclick="signOut()">Sign Out</button>
            </div>
        </div>
        
        <!-- Authentication Section (shown first) -->
        <div id="auth-page" class="auth-page">
            <div class="auth-container">
                <h2>Welcome</h2>
                <p>Sign in or create an account to get started</p>
                
                <div id="auth-tabs" class="auth-tabs">
                    <button class="auth-tab active" onclick="showLoginForm()">Sign In</button>
                    <button class="auth-tab" onclick="showSignupForm()">Create Account</button>
                </div>
                
                <!-- Login Form -->
                <div id="login-form" class="auth-form">
                    <div class="form-group">
                        <label for="login-email">Email:</label>
                        <input type="email" id="login-email" placeholder="Enter your email" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password:</label>
                        <input type="password" id="login-password" placeholder="Enter your password" class="form-input">
                        <a href="#" class="forgot-password-link" onclick="showForgotPasswordForm(); return false;">Forgot password?</a>
                    </div>
                    <button class="btn btn-primary" onclick="loginWithEmail()">Sign In</button>
                    <div id="login-error" class="auth-error hidden"></div>
                </div>
                
                <!-- Forgot Password Form -->
                <div id="forgot-password-form" class="auth-form hidden">
                    <h3>Reset Password</h3>
                    <p style="color: #666; margin-bottom: 20px;">Enter your email address and we'll send you a link to reset your password.</p>
                    <div class="form-group">
                        <label for="reset-email">Email:</label>
                        <input type="email" id="reset-email" placeholder="Enter your email" class="form-input">
                    </div>
                    <button class="btn btn-primary" onclick="sendPasswordReset()">Send Reset Link</button>
                    <button class="btn btn-secondary" onclick="backToLogin()" style="margin-top: 10px; background: #6c757d;">Back to Sign In</button>
                    <div id="reset-error" class="auth-error hidden"></div>
                    <div id="reset-success" class="auth-success hidden"></div>
                </div>
                
                <!-- Signup Form -->
                <div id="signup-form" class="auth-form hidden">
                    <div class="form-group">
                        <label for="signup-email">Email:</label>
                        <input type="email" id="signup-email" placeholder="Enter your email" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="signup-password">Password:</label>
                        <input type="password" id="signup-password" placeholder="Create a password (min 6 characters)" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="signup-name">Name (optional):</label>
                        <input type="text" id="signup-name" placeholder="Enter your name" class="form-input">
                    </div>
                    <button class="btn btn-primary" onclick="signupWithEmail()">Create Account</button>
                    <div id="signup-error" class="auth-error hidden"></div>
                </div>
                
                <div class="auth-divider">
                    <span>OR</span>
                </div>
                
                <button class="btn btn-google" onclick="signInWithGoogle()">
                    <svg width="18" height="18" viewBox="0 0 18 18" style="margin-right: 8px;">
                        <path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z"/>
                        <path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.956-2.184l-2.908-2.258c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332C2.438 15.983 5.482 18 9 18z"/>
                        <path fill="#FBBC05" d="M3.964 10.712c-.18-.54-.282-1.117-.282-1.712s.102-1.172.282-1.712V4.956H.957C.348 6.174 0 7.55 0 9s.348 2.826.957 4.044l3.007-2.332z"/>
                        <path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.956L3.964 7.288C4.672 5.163 6.656 3.58 9 3.58z"/>
                    </svg>
                    Continue with Google
                </button>
            </div>
        </div>
        
        <!-- Initial Setup Section (hidden until authenticated) -->
        <div id="setup-section" class="setup-section hidden">
            <h2>Initial Setup</h2>
            
            <div class="form-group">
                <label for="num-people">Number of People:</label>
                <input type="number" id="num-people" min="1" placeholder="4">
            </div>
            
            <div class="form-group">
                <label for="stack-value">How much is 1 stack worth? ($):</label>
                <input type="number" id="stack-value" min="0" step="0.01" placeholder="$10">
            </div>
            
            <div class="form-group">
                <label for="chips-per-stack">Chips per Stack:</label>
                <input type="number" id="chips-per-stack" min="1" step="1" placeholder="20">
            </div>
            
            <div class="form-group">
                <label class="toggle-label">
                    <input type="checkbox" id="same-value-toggle">
                    <span>All chips are worth the same</span>
                </label>
            </div>
            
            <div id="different-chips-section" class="hidden">
                <h3>Chip Values</h3>
                <div class="chip-inputs">
                    <div class="form-group">
                        <label for="black-value">Black Chip Value ($):</label>
                        <input type="number" id="black-value" min="0" step="0.01" value="0">
                    </div>
                    <div class="form-group">
                        <label for="white-value">White Chip Value ($):</label>
                        <input type="number" id="white-value" min="0" step="0.01" value="0">
                    </div>
                    <div class="form-group">
                        <label for="green-value">Green Chip Value ($):</label>
                        <input type="number" id="green-value" min="0" step="0.01" value="0">
                    </div>
                    <div class="form-group">
                        <label for="red-value">Red Chip Value ($):</label>
                        <input type="number" id="red-value" min="0" step="0.01" value="0">
                    </div>
                    <div class="form-group">
                        <label for="blue-value">Blue Chip Value ($):</label>
                        <input type="number" id="blue-value" min="0" step="0.01" value="0">
                    </div>
                </div>
            </div>
            
            <button id="setup-btn" class="btn btn-primary">Start Tracking</button>
        </div>
        
        <!-- Main Tracking Section -->
        <div id="tracking-section" class="tracking-section hidden">
            <div class="tracking-header">
                <div class="total-pot">
                    <h2>Total Pot: $<span id="total-pot-amount">0.00</span></h2>
                    <div id="chip-value-display" class="chip-value-display"></div>
                </div>
                <div class="header-actions">
                    <div id="user-info" class="user-info">
                        <span id="user-name"></span>
                        <button id="sign-out-btn" class="btn btn-sign-out" onclick="signOut()">Sign Out</button>
                    </div>
                    <button id="settlement-btn" class="btn btn-settlement" onclick="showSettlementModal()">Settlement</button>
                    <button id="add-person-btn" class="btn btn-add-person" onclick="showAddPersonForm()">+ Add Person</button>
                    <button id="reset-btn" class="btn btn-reset" onclick="resetData()">Reset All Data</button>
                </div>
            </div>
            
            <div id="chips-warning" class="chips-warning hidden"></div>
            
            <div id="people-widgets" class="people-widgets"></div>
            
            <div class="chip-total-tracker">
                <h3>Total Chips in Play: <span id="total-chips-amount">0</span></h3>
            </div>
            
            <div class="transaction-log">
                <h2>Transaction Log</h2>
                <div id="log-entries" class="log-entries"></div>
            </div>
        </div>
        
        <!-- Settlement Modal -->
        <div id="settlement-modal" class="modal hidden">
            <div class="modal-content">
                <div id="settlement-options" class="settlement-options">
                    <h2>Settlement Options</h2>
                    <button class="btn btn-settle-option" onclick="showHouseSettlement()">House Settle</button>
                    <button class="btn btn-settle-option" onclick="showPlayerToPlayerSettlement()">Player to Player Settlement</button>
                </div>
                
                <div id="house-settlement-view" class="settlement-view hidden">
                    <h2>House Settlement</h2>
                    <div id="house-settlement-results"></div>
                    <button class="btn btn-back" onclick="backToSettlementOptions()">Back</button>
                </div>
                
                <div id="player-settlement-view" class="settlement-view hidden">
                    <h2>Player to Player Settlement</h2>
                    <div id="player-settlement-results"></div>
                    <button class="btn btn-back" onclick="backToSettlementOptions()">Back</button>
                </div>
                
                <button class="btn btn-close-modal" onclick="closeSettlementModal()">Back to Dashboard</button>
            </div>
        </div>
    </div>
    
    <script src="/script.js"></script>
</body>
</html>

