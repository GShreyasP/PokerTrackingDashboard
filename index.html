<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- App Icon for Home Screen -->
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <title>SettleUP</title>
    <link rel="stylesheet" href="/style.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="/firebase-init.js"></script>
    <!-- Chart.js for analytics visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Left Sidebar Menu -->
        <div id="sidebar-menu" class="sidebar-menu hidden">
            <div class="sidebar-header">
                <h2>Menu</h2>
                <button class="sidebar-close-btn" onclick="toggleSidebarMenu()">Ã—</button>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="sidebar-menu-item" onclick="toggleSidebarMenu(); showMainScreen(); return false;">
                    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7"/>
                        <rect x="14" y="3" width="7" height="7"/>
                        <rect x="14" y="14" width="7" height="7"/>
                        <rect x="3" y="14" width="7" height="7"/>
                    </svg>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="sidebar-menu-item" onclick="toggleSidebarMenu(); toggleFriendsSidebar(); return false;">
                    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                        <circle cx="9" cy="7" r="4"/>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>
                    </svg>
                    <span>Friends</span>
                    <span id="sidebar-friends-badge" class="menu-badge hidden">0</span>
                </a>
                <a href="#" class="sidebar-menu-item" onclick="toggleSidebarMenu(); showInvitePeopleModal(); return false;">
                    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                        <circle cx="8.5" cy="7" r="4"/>
                        <path d="M20 8v6M23 11h-6"/>
                    </svg>
                    <span>Invite People</span>
                </a>
                <a href="#" class="sidebar-menu-item" onclick="toggleSidebarMenu(); showAnalyticsPage(); return false;">
                    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 3v18h18"/>
                        <path d="M7 12l4-4 4 4 6-6"/>
                    </svg>
                    <span>Analytics</span>
                </a>
                <a href="#" class="sidebar-menu-item" onclick="toggleSidebarMenu(); showSettingsModal(); return false;">
                    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                    </svg>
                    <span>Settings</span>
                </a>
                <a href="#" class="sidebar-menu-item" onclick="toggleSidebarMenu(); showUpgradePage(); return false;">
                    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                        <path d="M2 17l10 5 10-5M2 12l10 5 10-5"/>
                    </svg>
                    <span>Upgrade</span>
                </a>
                <div class="sidebar-divider"></div>
                <a href="#" class="sidebar-menu-item" onclick="toggleSidebarMenu(); signOut(); return false;">
                    <svg class="menu-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                        <polyline points="16 17 21 12 16 7"/>
                        <line x1="21" y1="12" x2="9" y2="12"/>
                    </svg>
                    <span>Sign Out</span>
                </a>
            </nav>
        </div>
        
        <!-- Sidebar Overlay -->
        <div id="sidebar-overlay-menu" class="sidebar-overlay-menu hidden" onclick="toggleSidebarMenu()"></div>
        
        <div class="page-header">
            <button id="hamburger-menu-btn" class="hamburger-menu-btn" onclick="toggleSidebarMenu()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="3" y1="6" x2="21" y2="6"/>
                    <line x1="3" y1="12" x2="21" y2="12"/>
                    <line x1="3" y1="18" x2="21" y2="18"/>
                </svg>
            </button>
            <div class="header-title-section">
                <h1>SettleUP</h1>
                <span id="user-plan-badge" class="plan-badge hidden"></span>
            </div>
            <div class="header-actions-right">
                <button id="install-app-btn" class="btn btn-install" onclick="showInstallInstructions()">Install App</button>
                <button id="notifications-btn" class="btn btn-notifications hidden" onclick="toggleNotificationsSidebar()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="notification-icon">
                        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
                        <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
                    </svg>
                    <span id="notifications-badge" class="notification-badge hidden">0</span>
                </button>
                <button id="new-table-btn" class="btn btn-new-table hidden" onclick="showSetupSection()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="plus-icon">
                        <path d="M12 5v14M5 12h14"/>
                    </svg>
                    New Table
                </button>
                <div id="header-user-info" class="header-user-info hidden">
                    <div class="header-user-details">
                        <span id="header-user-name"></span>
                        <span id="header-user-id" class="header-user-id"></span>
                    </div>
                </div>
            </div>
        </div>
        <script>
            // Immediately hide friends button and show install button on page load
            (function() {
                const friendsBtn = document.getElementById('friends-btn');
                if (friendsBtn) {
                    friendsBtn.classList.add('hidden');
                    friendsBtn.style.display = 'none';
                }
                const installAppBtn = document.getElementById('install-app-btn');
                if (installAppBtn) {
                    installAppBtn.classList.remove('hidden');
                    installAppBtn.style.display = '';
                }
            })();
        </script>
        
        <!-- Authentication Section (shown first) -->
        <div id="auth-page" class="auth-page">
            <!-- Animated Background Chips -->
            <div class="auth-bg-chips">
                <div class="auth-chip" style="--delay: 0s; --duration: 8s; --top: 10%;"></div>
                <div class="auth-chip" style="--delay: 2s; --duration: 9s; --top: 25%;"></div>
                <div class="auth-chip" style="--delay: 4s; --duration: 7s; --top: 40%;"></div>
                <div class="auth-chip" style="--delay: 1s; --duration: 8.5s; --top: 55%;"></div>
                <div class="auth-chip" style="--delay: 3s; --duration: 7.5s; --top: 70%;"></div>
                <div class="auth-chip" style="--delay: 5s; --duration: 8s; --top: 85%;"></div>
                <div class="auth-chip" style="--delay: 1.5s; --duration: 9s; --top: 15%;"></div>
                <div class="auth-chip" style="--delay: 3.5s; --duration: 7s; --top: 50%;"></div>
                <div class="auth-chip" style="--delay: 5.5s; --duration: 8.5s; --top: 75%;"></div>
            </div>
            <div class="auth-container">
                <h2>Welcome</h2>
                <p>Sign in or create an account to get started</p>
                
                <div id="auth-tabs" class="auth-tabs">
                    <button class="auth-tab active" onclick="showLoginForm()">Sign In</button>
                    <button class="auth-tab" onclick="showSignupForm()">Create Account</button>
                </div>
                
                <!-- Login Form -->
                <div id="login-form" class="auth-form">
                    <div class="form-group">
                        <label for="login-email">Email:</label>
                        <input type="email" id="login-email" placeholder="Enter your email" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password:</label>
                        <input type="password" id="login-password" placeholder="Enter your password" class="form-input">
                        <a href="#" class="forgot-password-link" onclick="showForgotPasswordForm(); return false;">Forgot password?</a>
                    </div>
                    <button class="btn btn-primary" onclick="loginWithEmail()">Sign In</button>
                    <div id="login-error" class="auth-error hidden"></div>
                </div>
                
                <!-- Forgot Password Form -->
                <div id="forgot-password-form" class="auth-form hidden">
                    <h3>Reset Password</h3>
                    <p style="color: #666; margin-bottom: 20px;">Enter your email address and we'll send you a link to reset your password.</p>
                    <div class="form-group">
                        <label for="reset-email">Email:</label>
                        <input type="email" id="reset-email" placeholder="Enter your email" class="form-input">
                    </div>
                    <button class="btn btn-primary" onclick="sendPasswordReset()">Send Reset Link</button>
                    <button class="btn btn-secondary" onclick="backToLogin()" style="margin-top: 10px; background: #6c757d;">Back to Sign In</button>
                    <div id="reset-error" class="auth-error hidden"></div>
                    <div id="reset-success" class="auth-success hidden"></div>
                </div>
                
                <!-- Signup Form -->
                <div id="signup-form" class="auth-form hidden">
                    <div class="form-group">
                        <label for="signup-email">Email:</label>
                        <input type="email" id="signup-email" placeholder="Enter your email" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="signup-password">Password:</label>
                        <input type="password" id="signup-password" placeholder="Create a password (min 6 characters)" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="signup-name">Name (optional):</label>
                        <input type="text" id="signup-name" placeholder="Enter your name" class="form-input">
                    </div>
                    <button class="btn btn-primary" onclick="signupWithEmail()">Create Account</button>
                    <div id="signup-error" class="auth-error hidden"></div>
                </div>
                
                <div class="auth-divider">
                    <span>OR</span>
                </div>
                
                <button class="btn btn-google" onclick="signInWithGoogle()">
                    <svg width="18" height="18" viewBox="0 0 18 18" style="margin-right: 8px;">
                        <path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z"/>
                        <path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.956-2.184l-2.908-2.258c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332C2.438 15.983 5.482 18 9 18z"/>
                        <path fill="#FBBC05" d="M3.964 10.712c-.18-.54-.282-1.117-.282-1.712s.102-1.172.282-1.712V4.956H.957C.348 6.174 0 7.55 0 9s.348 2.826.957 4.044l3.007-2.332z"/>
                        <path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.956L3.964 7.288C4.672 5.163 6.656 3.58 9 3.58z"/>
                    </svg>
                    Continue with Google
                </button>
            </div>
        </div>
        
        <!-- Main Screen (shown when authenticated but no tracker) -->
        <div id="main-screen" class="main-screen hidden">
            <div class="main-screen-content">
                <div id="tracker-limit-error" class="tracker-limit-error hidden">
                    <span id="tracker-limit-error-message"></span>
                    <button id="tracker-limit-upgrade-btn" class="tracker-limit-upgrade-btn hidden" onclick="showUpgradePage(); return false;">Upgrade Now</button>
                </div>
                
                <!-- Your Tables Section -->
                <section class="your-tables-section" style="margin-bottom: 48px;">
                    <div class="section-header">
                        <div>
                            <h2 class="section-title">Your Tables</h2>
                            <p class="section-subtitle">Manage and track your poker games</p>
                        </div>
                    </div>
                    <div id="your-tables-container" class="tables-grid">
                        <div class="empty-state" id="your-tables-empty">
                            <div class="empty-icon">ðŸŽ²</div>
                            <h3 class="empty-title">No tables created yet</h3>
                            <p class="empty-description">Create your first table to start tracking your poker games and winnings</p>
                        </div>
                    </div>
                </section>
                
                <!-- Live Tables Section -->
                <section class="live-tables-section">
                    <div class="section-header">
                        <div>
                            <h2 class="section-title">Live Tables</h2>
                            <p class="section-subtitle">Join ongoing games from your friends</p>
                        </div>
                    </div>
                    <div id="live-tables-container" class="tables-grid">
                        <div class="empty-state" id="live-tables-empty">
                            <div class="empty-icon">ðŸŽ²</div>
                            <h3 class="empty-title">No live tables available</h3>
                            <p class="empty-description">No friends are currently hosting active games</p>
                        </div>
                    </div>
                </section>
            </div>
        </div>
        
        <!-- Settings Page -->
        <div id="settings-page" class="settings-page hidden">
            <div class="settings-content">
                <div class="settings-header">
                    <h2>Settings</h2>
                </div>
                <div class="settings-section">
                    <div class="settings-item">
                        <label class="settings-label">Credits</label>
                        <p class="settings-description">You have <span id="settings-credits-display" class="credits-value">0</span> credit(s) remaining. Each table creation uses 1 credit.</p>
                        <div class="credits-info">
                            <p class="credits-note">Purchase the Pay as you Play plan to add more credits.</p>
                            <button id="refresh-credits-btn" class="btn btn-secondary" onclick="refreshCredits()" style="margin-top: 8px; padding: 8px 16px; font-size: 0.9em;">Refresh Credits</button>
                        </div>
                    </div>
                    <div class="settings-item">
                        <label for="settings-username" class="settings-label">Username</label>
                        <p class="settings-description">Change your display name</p>
                        <input type="text" id="settings-username" class="settings-input" placeholder="Enter your username" onblur="saveUsername(this.value)">
                    </div>
                    <div class="settings-item">
                        <label for="settings-unique-id" class="settings-label">Unique ID (Zelle/Venmo)</label>
                        <p class="settings-description">Your unique identifier for Zelle or Venmo payments</p>
                        <input type="text" id="settings-unique-id" class="settings-input" placeholder="Enter your Zelle/Venmo ID" onblur="saveUniqueId(this.value)">
                    </div>
                </div>
                <div class="settings-footer">
                    <button class="btn btn-secondary" onclick="showMainScreen()">Back to Home</button>
                </div>
            </div>
        </div>
        
        <!-- Analytics Page -->
        <div id="analytics-page" class="analytics-page hidden">
            <div class="analytics-content">
                <div class="analytics-header">
                    <h2>Analytics</h2>
                </div>
                <!-- Stats Overview (moved from home page) -->
                <div class="stats-grid" style="margin-bottom: 40px;">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-label">Total Tables</div>
                            <div class="stat-icon">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                                </svg>
                            </div>
                        </div>
                        <div class="stat-value" id="stat-total-tables">0</div>
                        <div class="stat-change">
                            <span id="stat-total-tables-text">Create your first table</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-label">Active Sessions</div>
                            <div class="stat-icon">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                    <path d="M12 6v6l4 2"/>
                                </svg>
                            </div>
                        </div>
                        <div class="stat-value" id="stat-active-sessions">0</div>
                        <div class="stat-change">
                            <span id="stat-active-sessions-text">Live tables available</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-label">Win Rate</div>
                            <div class="stat-icon">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2">
                                    <path d="M3 3v18h18"/>
                                    <path d="M7 12l4-4 4 4 6-6"/>
                                </svg>
                            </div>
                        </div>
                        <div class="stat-value" id="stat-win-rate">-%</div>
                        <div class="stat-change">
                            <span id="stat-win-rate-text">No data yet</span>
                        </div>
                    </div>
                </div>
                <div id="analytics-stats" class="analytics-stats">
                    <div class="stat-card">
                        <div class="stat-label">Total PNL</div>
                        <div id="total-pnl" class="stat-value">$0.00</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Games Played</div>
                        <div id="games-played" class="stat-value">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Average PNL per Game</div>
                        <div id="avg-pnl" class="stat-value">$0.00</div>
                    </div>
                </div>
                <!-- PNL Over Time Chart -->
                <div class="analytics-chart-section">
                    <h3>PNL Over Time</h3>
                    <div class="chart-container">
                        <canvas id="pnl-chart"></canvas>
                    </div>
                </div>
                <!-- Friend Leaderboard -->
                <div class="analytics-leaderboard-section">
                    <h3>Friend Leaderboard</h3>
                    <div id="friend-leaderboard" class="leaderboard-container">
                        <p class="no-analytics">Loading leaderboard...</p>
                    </div>
                </div>
                <div class="analytics-history">
                    <h3>Game History</h3>
                    <div id="analytics-history-list" class="analytics-history-list">
                        <p class="no-analytics">No games recorded yet. Delete a table after playing to see analytics.</p>
                    </div>
                </div>
                <div class="analytics-footer">
                    <button class="btn btn-secondary" onclick="showMainScreen()">Back to Home</button>
                </div>
            </div>
        </div>
        
        <!-- Upgrade Page -->
        <div id="upgrade-page" class="upgrade-page hidden">
            <div class="upgrade-content">
                <div class="upgrade-header">
                    <h2>Upgrade Your Plan</h2>
                    <p class="upgrade-subtitle">Choose the plan that works best for you</p>
                </div>
                <div class="pricing-cards">
                    <!-- Pay as you Play Plan -->
                    <div class="pricing-card featured">
                        <div class="pricing-badge">Popular</div>
                        <div class="pricing-card-header">
                            <h3>Pay as you Play</h3>
                            <div class="pricing-price">
                                <span class="price-amount">$1.00</span>
                                <span class="price-period">per tracker</span>
                            </div>
                        </div>
                        <div class="pricing-features">
                            <ul>
                                <li>Pay only for what you use</li>
                                <li>No monthly commitment</li>
                                <li>Perfect for occasional players</li>
                            </ul>
                        </div>
                        <button class="btn btn-primary pricing-btn" onclick="handlePayAsYouPlay()">Get Started</button>
                    </div>
                    
                    <!-- Monthly Subscription -->
                    <div class="pricing-card">
                        <div class="pricing-card-header">
                            <h3>Monthly Subscription</h3>
                            <div class="pricing-price">
                                <span class="price-amount">$4.99</span>
                                <span class="price-period">/month</span>
                            </div>
                        </div>
                        <div class="pricing-features">
                            <ul>
                                <li>Unlimited trackers</li>
                                <li>Cancel anytime</li>
                                <li>Best for regular players</li>
                            </ul>
                        </div>
                        <button class="btn btn-primary pricing-btn" onclick="handleMonthlySubscription()">Join Now</button>
                    </div>
                    
                    <!-- 6 Month Subscription -->
                    <div class="pricing-card">
                        <div class="pricing-card-header">
                            <h3>6 Month Subscription</h3>
                            <div class="pricing-price">
                                <span class="price-amount">$19.99</span>
                                <span class="price-period">/6 months</span>
                            </div>
                            <div class="pricing-savings">Save $10.00</div>
                        </div>
                        <div class="pricing-features">
                            <ul>
                                <li>Unlimited trackers</li>
                                <li>Best value</li>
                                <li>Save 33% vs monthly</li>
                            </ul>
                        </div>
                        <button class="btn btn-primary pricing-btn" onclick="handleSixMonthSubscription()">Join Now</button>
                    </div>
                </div>
                <div class="upgrade-footer">
                    <button class="btn btn-secondary" onclick="showMainScreen()">Back to Home</button>
                </div>
            </div>
        </div>
        
        <!-- Initial Setup Section (hidden until authenticated) -->
        <div id="setup-section" class="setup-section hidden">
            <h2>Initial Setup</h2>
            
            <div class="form-group">
                <label for="num-people">Number of People:</label>
                <input type="number" id="num-people" min="1" max="20" placeholder="0">
                <div id="num-people-error" class="form-error hidden" style="color: #fca5a5; font-size: 13px; margin-top: 8px;">Number of people cannot be more than 20</div>
            </div>
            
            <div class="form-group">
                <label for="stack-value">How much is 1 stack worth? ($):</label>
                <input type="number" id="stack-value" min="0" step="0.01" placeholder="0">
            </div>
            
            <div class="form-group">
                <label for="chips-per-stack">Chips per Stack:</label>
                <input type="number" id="chips-per-stack" min="1" step="1" placeholder="0">
            </div>
            
            <div class="form-group">
                <label class="toggle-label">
                    <input type="checkbox" id="same-value-toggle">
                    <span>All chips are worth the same</span>
                </label>
            </div>
            
            <div id="different-chips-section">
                <h3>Chip Values</h3>
                <div class="chip-inputs">
                    <div class="form-group">
                        <label for="black-value">Black Chip Value ($):</label>
                        <input type="number" id="black-value" min="0" step="0.01" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="white-value">White Chip Value ($):</label>
                        <input type="number" id="white-value" min="0" step="0.01" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="green-value">Green Chip Value ($):</label>
                        <input type="number" id="green-value" min="0" step="0.01" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="red-value">Red Chip Value ($):</label>
                        <input type="number" id="red-value" min="0" step="0.01" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="blue-value">Blue Chip Value ($):</label>
                        <input type="number" id="blue-value" min="0" step="0.01" placeholder="0">
                    </div>
                </div>
                
                <h3 style="margin-top: 20px;">Number of Chips per Stack</h3>
                <div class="chip-inputs">
                    <div class="form-group">
                        <label for="black-count">Number of Black Chips:</label>
                        <input type="number" id="black-count" min="0" step="1" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="white-count">Number of White Chips:</label>
                        <input type="number" id="white-count" min="0" step="1" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="green-count">Number of Green Chips:</label>
                        <input type="number" id="green-count" min="0" step="1" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="red-count">Number of Red Chips:</label>
                        <input type="number" id="red-count" min="0" step="1" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="blue-count">Number of Blue Chips:</label>
                        <input type="number" id="blue-count" min="0" step="1" placeholder="0">
                    </div>
                </div>
            </div>

            <div class="setup-actions">
                <button id="setup-btn" class="btn btn-primary">Start Tracking</button>
            </div>
        </div>
        
        <div class="setup-actions" style="margin-top: 20px;">
        
        <!-- Main Tracking Section -->
        <div id="tracking-section" class="tracking-section hidden">
            <div class="tracking-header">
                <div class="total-pot">
                    <h2>Total Pot: $<span id="total-pot-amount">0.00</span></h2>
                    <div id="chip-value-display" class="chip-value-display"></div>
                </div>
                <div class="header-actions">
                    <button id="settlement-btn" class="btn btn-settlement" onclick="showSettlementModal()">Settlement</button>
                    <button id="add-person-btn" class="btn btn-add-person" onclick="showAddPersonForm()">+ Add Person</button>
                    <button id="reset-btn" class="btn btn-reset" onclick="showSettlementModalForEndGame()">End Game</button>
                </div>
            </div>
            
            <div id="chips-warning" class="chips-warning hidden"></div>
            
            <div id="people-widgets" class="people-widgets"></div>
            
            <div class="chip-total-tracker">
                <h3>Total Chips in Play: <span id="total-chips-amount">0</span></h3>
            </div>
            
            <div class="transaction-log">
                <h2>Transaction Log</h2>
                <div id="log-entries" class="log-entries"></div>
                <button id="clear-table-btn" class="btn btn-clear-table" onclick="clearTable()">Clear Table</button>
            </div>
        </div>
        
        <!-- Settlement Modal -->
        <div id="settlement-modal" class="modal hidden">
            <div class="modal-content">
                <div id="settlement-options" class="settlement-options">
                    <h2>Settlement Options</h2>
                    <button class="btn btn-settle-option" onclick="showHouseSettlement()">House Settle</button>
                    <button class="btn btn-settle-option" onclick="showPlayerToPlayerSettlement()">Player to Player Settlement</button>
                    <button id="back-to-tracker-btn" class="btn btn-secondary hidden" onclick="backToTracker()" style="margin-top: 15px;">Back to Tracker</button>
                </div>
                
                <div id="house-settlement-view" class="settlement-view hidden">
                    <h2>House Settlement</h2>
                    <div id="house-settlement-results"></div>
                    <div class="settlement-actions">
                        <button class="btn btn-back" onclick="backToSettlementOptions()">Back</button>
                        <button id="end-game-from-house" class="btn btn-reset hidden" onclick="confirmEndGame()">End Game</button>
                    </div>
                </div>
                
                <div id="player-settlement-view" class="settlement-view hidden">
                    <h2>Player to Player Settlement</h2>
                    <div id="player-settlement-results"></div>
                    <div class="settlement-actions">
                        <button class="btn btn-back" onclick="backToSettlementOptions()">Back</button>
                        <button id="end-game-from-player" class="btn btn-reset hidden" onclick="confirmEndGame()">End Game</button>
                    </div>
                </div>
                
                <button id="back-to-dashboard-btn" class="btn btn-close-modal" onclick="closeSettlementModal()">Back to Dashboard</button>
            </div>
        </div>
        
        <!-- Friends Sidebar -->
        <div id="friends-sidebar" class="friends-sidebar hidden">
            <div class="friends-sidebar-header">
                <h2>Friends</h2>
                <button class="btn-close-sidebar" onclick="toggleFriendsSidebar()">Ã—</button>
            </div>
            
            <div class="friends-sidebar-content">
                <!-- Add Friend Section -->
                <div class="friends-add-section">
                    <h3>Add Friend</h3>
                    <div class="friends-search">
                        <input type="text" id="friend-search-input" placeholder="Search by username" class="form-input">
                        <button class="btn btn-primary btn-sm" onclick="searchFriend()">Search</button>
                    </div>
                    <div id="friend-search-results" class="friend-search-results hidden"></div>
                    
                    <div class="friends-invite-section">
                        <h4>Or Invite by Link</h4>
                        <div class="invite-link-container">
                            <div class="invite-link-text" id="invite-link-text">https://poker-tracking-dashboard.vercel.app/</div>
                            <button class="btn btn-primary btn-sm" onclick="copyInviteLink()">Copy Link</button>
                        </div>
                        <small>Share this link with friends to invite them</small>
                    </div>
                </div>
                
                <!-- Tracker Join Requests Section -->
                <div id="tracker-join-requests-section" class="friends-section hidden">
                    <h3>Tracker Join Requests</h3>
                    <div id="tracker-join-requests-list" class="friends-list"></div>
                </div>
                
                <!-- Tracker Access Requests Section -->
                <div id="tracker-access-requests-section" class="friends-section hidden">
                    <h3>Tracker Access Requests</h3>
                    <div id="tracker-access-requests-list" class="friends-list"></div>
                </div>
                
                <!-- Friend Requests Section -->
                <div id="friend-requests-section" class="friends-section hidden">
                    <h3>Friend Requests</h3>
                    <div id="friend-requests-list" class="friends-list"></div>
                </div>
                
                <!-- Online Friends Section -->
                <div id="online-friends-section" class="friends-section">
                    <h3>Online Friends</h3>
                    <div id="online-friends-list" class="friends-list">
                        <p class="no-friends">No online friends</p>
                    </div>
                </div>
                
                <!-- Offline Friends Section -->
                <div id="offline-friends-section" class="friends-section">
                    <h3>Offline Friends</h3>
                    <div id="offline-friends-list" class="friends-list">
                        <p class="no-friends">No offline friends</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Overlay for sidebar -->
        <div id="sidebar-overlay" class="sidebar-overlay hidden" onclick="toggleFriendsSidebar()"></div>
        
        <!-- Custom Modal for Amount Input -->
        <!-- Install Instructions Modal -->
        <div id="install-instructions-modal" class="custom-modal hidden" onclick="if(event.target === this) closeInstallInstructions()">
            <div class="custom-modal-content" onclick="event.stopPropagation()">
                <div class="custom-modal-header">
                    <h2>Install App</h2>
                    <button class="modal-close-btn" onclick="closeInstallInstructions()">Ã—</button>
                </div>
                <div class="custom-modal-body">
                    <ol style="text-align: left; padding-left: 20px; line-height: 1.8;">
                        <li>Press Share (found in browser)</li>
                        <li>Scroll down to find "Add to Home"</li>
                        <li>Leave everything as is and press "Add"</li>
                    </ol>
                </div>
                <div class="custom-modal-footer">
                    <button class="btn btn-primary" onclick="closeInstallInstructions()">Got it</button>
                </div>
            </div>
        </div>
        
        <div id="amount-input-modal" class="custom-modal hidden" onclick="if(event.target === this) closeAmountInputModal()">
            <div class="custom-modal-content" onclick="event.stopPropagation()">
                <div class="custom-modal-header">
                    <h3 id="amount-input-title">Enter Amount</h3>
                </div>
                <div class="custom-modal-body">
                    <p id="amount-input-message">Enter the amount of money you want to put in the tracker:</p>
                    <input type="number" id="amount-input-field" class="custom-modal-input" placeholder="0.00" step="0.01" min="0.01">
                    <div id="quick-add-buttons" class="quick-add-buttons" style="margin-top: 16px; display: none;">
                        <button type="button" class="btn-quick-add" id="quick-add-50" onclick="useQuickAdd(0.5)">50% Stack</button>
                        <button type="button" class="btn-quick-add" id="quick-add-100" onclick="useQuickAdd(1)">100% Stack</button>
                        <button type="button" class="btn-quick-add" id="quick-add-200" onclick="useQuickAdd(2)">200% Stack</button>
                    </div>
                </div>
                <div class="custom-modal-footer">
                    <button class="btn btn-secondary" onclick="closeAmountInputModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="confirmAmountInput()">OK</button>
                </div>
            </div>
        </div>
        
        <!-- Custom Modal for Alert/Confirmation -->
        <div id="alert-modal" class="custom-modal hidden" onclick="if(event.target === this) closeAlertModal()">
            <div class="custom-modal-content" onclick="event.stopPropagation()">
                <div class="custom-modal-header">
                    <h3>Notification</h3>
                </div>
                <div class="custom-modal-body">
                    <p id="alert-message"></p>
                </div>
                <div class="custom-modal-footer">
                    <button class="btn btn-primary" onclick="closeAlertModal()">OK</button>
                </div>
            </div>
        </div>
        
        <!-- Confirmation Modal for PAYP Credit Usage -->
        <div id="confirm-modal" class="custom-modal hidden" onclick="if(event.target === this) closeConfirmModal()">
            <div class="custom-modal-content" onclick="event.stopPropagation()">
                <div class="custom-modal-header">
                    <h3>Confirm Table Creation</h3>
                </div>
                <div class="custom-modal-body">
                    <p id="confirm-message"></p>
                </div>
                <div class="custom-modal-footer">
                    <button class="btn btn-secondary" onclick="closeConfirmModal()">Cancel</button>
                    <button class="btn btn-primary" id="confirm-yes-btn" onclick="confirmCreateTracker()">Create Table</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="/script.js"></script>
</body>
</html>

